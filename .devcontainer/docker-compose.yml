services:
  # Servicio de base de datos MySQL:
  database:
    image: mysql:8.0.41-bookworm
    environment:
      MYSQL_ROOT_PASSWORD: edqnLMCSf31.
      MYSQL_DATABASE: cauz
      MYSQL_USER: developer
      MYSQL_PASSWORD: anypassword
    ports:
      - "4002:3306"
    volumes:
      - db-cauz:/var/lib/mysql
    networks:
      - net-cauz
    restart: always
  # Servicio de Flask:
  flask:
    build:
      context: ../alertas/
      dockerfile: Dockerfile
    volumes: # Hacer refencia a la carpeta flask (Donde ese esta programando el proyecto)
      - ../alertas/:/flask_services
    ports:
      - "4001:4001"
    networks:
      - net-cauz
    restart: always
  # Servicio de backend: (django)
  backend:
    build:
      context: ../backend/
      dockerfile: Dockerfile
    command: bash -c "sleep 60 && python manage.py migrate && python manage.py runserver 0.0.0.0:4000"
    volumes: # Hacer refencia a la carpeta backend (Donde ese esta programando el proyecto)
      - ../backend/:/app
    ports:
      - "4000:4000"
    networks:
      - net-cauz
    depends_on:
      - database
      - flask
    restart: always
volumes:
  db-cauz:
networks:
  # Red de tipo bridge
  net-cauz:
    driver: bridge
